# directive 指令
>
    指令：AngularJs利用特殊的属性将HTML元素与Javascript逻辑联系起来，从而扩展HTML的功能
    编译(compile): 意味着将指令附加到HTML元素上，从而使其可交互
    指令类型： 可以是标签、属性、class和注释，最佳实践建议，优先使用标签和属性。
 
## angular属性前缀： ['ng-', 'data-ng-', 'ng:', 'x-ng-']
## 创建指令
>
    向控制器一样，指令也在模块上注册。使用module.directive(name, directorFactory)。directorFactory需要返回一个单体属性配置对象，以便告
    诉编译器指令会有哪些行为。
    directorFactory函数，只会在指令被编译器第一次匹配到的时候调用一次。你可以在这里完成初始化的工作。这个函数使用$injector.invoke调用，
    从而使其能像控制器一样可以被注入


## ng-app
* 标示应用root element,用于自动引导应用
* 只会识别第一个标识，如果一个页面有多个应用，必须使用手动引导 angular.bootstrap，且应用之间不能嵌套
* g-strict-di设置在根应用上，注入器将在strict-di模式下产生，意味着，自动函数注解将产生错误。
```
angular.module('ngAppStrictDemo', [])                                                            
  // 因为控制器依赖自动注解，欧意会实例化失败                                                        
  .controller('BadController', function($scope) {                                                
    $scope.a = 1;                                                                                
    $scope.b = 2;                                                                                
  })                                                                                             
  // 不像BadController, GoodController和GoodController2不会实例化失败, 
  // 因为使用数组形式和$inject属性,明确了注解 
  .controller('GoodController1', ['$scope', function($scope) {                                   
    $scope.a = 1;                                                                                
    $scope.b = 2;                                                                                
  }])                                                                                            
  .controller('GoodController2', GoodController2);                                               
  function GoodController2($scope) {                                                             
    $scope.name = "World";                                                                       
  }                                                                                              
  GoodController2.$inject = ['$scope'];                                                          
```

## angular.bootstrap(element, modules, config)

config现在只有一个配置项可用`strictDi`，用于是否禁用自动注解，便于发现bug
返回：auto.$injector 给该应用

```html                                                       
<!doctype html>                                               
<html>                                                        
<body>                                                        
<div ng-controller="WelcomeController">                       
  {{greeting}}                                                
</div>                                                        
                                                              
<script src="angular.js"></script>                            
<script>                                                      
  var app = angular.module('demo', [])                        
  .controller('WelcomeController', function($scope) {         
      $scope.greeting = 'Welcome!';                           
  });                                                         
  angular.bootstrap(document, ['demo']);                      
</script>                                                     
</body>                                                       
</html>                                                       
```                   
                                        
## 注解 annotation     
js没有注解，注解是来自spring的概念，因为没有用过spring,所以也无法想通过它帮助理解。暂时理解为，注入解释.

**有以下三种函数注解方式：**

```js                                                     
  // inferred (only works if code not minified/obfuscated)
  $injector.invoke(function(serviceA){});                 
                                                          
  // annotated                                            
  function explicit(serviceA) {};                         
  explicit.$inject = ['serviceA'];                        
  $injector.invoke(explicit);                             
                                                          
  // inline                                               
  $injector.invoke(['serviceA', function(serviceA){}]);   
```                                                       

### Inference 推论
js中通过对函数调用toString()可以返回函数对定义，并可以提取到参数。但注入器在严格模式是不允许的。
  当压缩和混淆代码的时候，参数也会被压缩改变。

### $inject 注解
可以通过在函数上添加$inject属性，指定注入参数          

### inline
使用注入参数数组，数组的最后一项是调用函数 

### 注入器实例的方法
* get(serviceName, caller) 对应内部getService(),返回一个服务的实例。serviceName服务名；caller提供一个供错误消息的调用
* invoke(fn, self, locals, serviceName) 调用该方法，并应用从$injector取得的方法参数。 fn调用的方法；self:fn的this; locals:可选对象，如果存在，首先从对象取参数
* has(name) 查询服务是否存在。
* instantiate(Type, locals, serviceName) 实例化一个js类型，需要一个构造函数，使用new调用，并应用构造函数指定的注解参数。Type：一个构造函数；locals:可选，如果传入，优先从其上读取参数。
* annotate(fn, strictDi, names) 与createInjector.$$annotate指向同个函数。被注射器使用，当函数调用的时候，用于判断哪些服务将被注入。返回服务名数组。
         
## service#provider                    
提供一系列方法，来使用$injector注册组件。同时，其中的许多方法也暴露给来module.
**service**是由**service factory**创建的单体对象，而**service factory**又是由**service provider**创建的函数。
**service providers** 是构造函数，实例化的时候必须包含一个`$get`属性
当你需要一个service的时候, $injector负责找到对应的**service provider**，并实例化它，然后调用它的`$get` **service factory** 方法获取到**service**实例 
通常services没有配置选项，也没有必要为service provider添加方法.  provider不会有超过一个`$get`属性的构造函数. 对于这种情况，$provide有其它的辅助方法来注册服务，并且不用指定providere的情况下 
         
# 指令
指令对象，向编译器提供指令。参数如下：

* multiElement  如果设置成true,HTML编译器将收集带`directive-name-start` 和`directive-name-end`属性的节点之间的所有DOM元素，组合它们为指令的元素。
```
// 自带指令ngRepeat的start和end的使用。
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <script src="../lib/angular-1.3.16/angular.min.js"></script>
    <script src=""></script>
    <title></title>
    <script language="JavaScript">
        var app = angular.module("app", []);
        app.run(function ($rootScope) {
            $rootScope.list = [{name: '张三', age: 26, gender: '男'}, {name: '李四', age: 24, gender: '男'}];
        });
    </script>
</head>
<body ng-app="app">
<table border="1">
    <tbody>
    <tr ng-repeat-start="l in list">
        <td>{{l.name}}</td>
        <td></td>
    </tr>
    <tr ng-repeat-end>
        <td>{{l.age}}</td>
        <td>{{l.gender}}</td>
    </tr>
    </tbody>
</table>
</body>
</html>
```

* priority  当一个DOM元素上存在多个指令的时候，有时候就需要指定哪个指令生效。用于指令编译前对指令的排序，值为数字，数字越大，就会越早编译，默认为0，同样级别的为undefined
* terminal  如果设置成true,当前priority将会成为最后被执行的指令集。
* scope 其值可以为true、对象或为假的值。如果为false,将不会创建指令的scope, 会沿用父级的scope; 
* bindToController  
* controller
* require
* controllerAs
* restrict
* templateNamespace
* template
* templateUrl
* replace
* transclude
* compile
* link
* Pre-linking function
* Post-linking function
* Transclusion
* Transclusion Functions
* Transclusion Scopes
* Attributes
         
         
